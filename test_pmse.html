<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Thom Benjamin Volker">
<meta name="dcterms.date" content="2023-01-22">

<title>Can the pMSE detect missing relationships between variables?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="test_pmse_files/libs/clipboard/clipboard.min.js"></script>
<script src="test_pmse_files/libs/quarto-html/quarto.js"></script>
<script src="test_pmse_files/libs/quarto-html/popper.min.js"></script>
<script src="test_pmse_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="test_pmse_files/libs/quarto-html/anchor.min.js"></script>
<link href="test_pmse_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="test_pmse_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="test_pmse_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="test_pmse_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="test_pmse_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="test_pmse_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="test_pmse_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Can the <span class="math inline">\(pMSE\)</span> detect missing relationships between variables?</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Thom Benjamin Volker </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 22, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>The answer is “No; at least it’s not very good”.</p>
<section id="properties-pmse-for-cart-logistic-regression-and-lasso-regression" class="level1">
<h1>Properties <span class="math inline">\(pMSE\)</span> for CART, logistic regression and lasso regression</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(synthpop)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="generate-data" class="level2">
<h2 class="anchored" data-anchor-id="generate-data">Generate data</h2>
<section id="three-predictor-variables" class="level3">
<h3 class="anchored" data-anchor-id="three-predictor-variables">Three predictor variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>P3 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>M3 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, P3)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>SR3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(r, P3, P3)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(SR3) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>SS3 <span class="ot">&lt;-</span> <span class="fu">diag</span>(P3)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>XR3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N<span class="sc">*</span>P3) <span class="sc">|&gt;</span> <span class="fu">matrix</span>(N, P3) <span class="sc">%*%</span> <span class="fu">chol</span>(SR3)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>XS3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N<span class="sc">*</span>P3) <span class="sc">|&gt;</span> <span class="fu">matrix</span>(N, P3) <span class="sc">%*%</span> <span class="fu">chol</span>(SS3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ten-predictor-variables" class="level3">
<h3 class="anchored" data-anchor-id="ten-predictor-variables">Ten predictor variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>P10 <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>M10 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, P10)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>SR10 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(r, P10, P10)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(SR10) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>SS10 <span class="ot">&lt;-</span> <span class="fu">diag</span>(P10)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>XR10 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N<span class="sc">*</span>P10) <span class="sc">|&gt;</span> <span class="fu">matrix</span>(N, P10) <span class="sc">%*%</span> <span class="fu">chol</span>(SR10)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>XS10 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N<span class="sc">*</span>P10) <span class="sc">|&gt;</span> <span class="fu">matrix</span>(N, P10) <span class="sc">%*%</span> <span class="fu">chol</span>(SS10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="twenty-predictor-variables" class="level3">
<h3 class="anchored" data-anchor-id="twenty-predictor-variables">Twenty predictor variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>P20 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>M20 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, P20)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>SR20 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(r, P20, P20)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(SR20) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>SS20 <span class="ot">&lt;-</span> <span class="fu">diag</span>(P20)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>XR20 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N<span class="sc">*</span>P20) <span class="sc">|&gt;</span> <span class="fu">matrix</span>(N, P20) <span class="sc">%*%</span> <span class="fu">chol</span>(SR20)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>XS20 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N<span class="sc">*</span>P20) <span class="sc">|&gt;</span> <span class="fu">matrix</span>(N, P20) <span class="sc">%*%</span> <span class="fu">chol</span>(SS20)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="compare-real-and-synthetic-data" class="level2">
<h2 class="anchored" data-anchor-id="compare-real-and-synthetic-data">Compare real and synthetic data</h2>
<div class="cell" data-hash="test_pmse_cache/html/unnamed-chunk-5_bbd6158b8aeaffb5178d48e8a8ef95f9">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>CART <span class="ot">&lt;-</span> <span class="fu">map2_dbl</span>(<span class="fu">list</span>(XR3, XR10, XR20),</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">list</span>(XS3, XS10, XS20),</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                 <span class="sc">~</span>synthpop<span class="sc">::</span><span class="fu">utility.gen</span>(<span class="fu">data.frame</span>(.x),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">data.frame</span>(.y),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">method =</span> <span class="st">"cart"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">print.flag=</span>F)<span class="sc">$</span>S_pMSE)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>logistic <span class="ot">&lt;-</span> <span class="fu">map2_dbl</span>(<span class="fu">list</span>(XR3, XR10, XR20),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">list</span>(XS3, XS10, XS20),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                     <span class="sc">~</span>synthpop<span class="sc">::</span><span class="fu">utility.gen</span>(<span class="fu">data.frame</span>(.x),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">data.frame</span>(.y),</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">method =</span> <span class="st">"logit"</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">print.flag=</span>F,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">maxorder =</span> <span class="dv">1</span>)<span class="sc">$</span>S_pMSE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>You will be fitting a large model with  211  parameters and only  500  records
that may take a long time and fail to converge.
Have you selected variables with vars?</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>lasso <span class="ot">&lt;-</span> <span class="fu">map2_dbl</span>(<span class="fu">list</span>(XR3, XR10, XR20),</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">list</span>(XS3, XS10, XS20),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                  <span class="cf">function</span>(real, synthetic) {</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                    form <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Synthetic ~ .^3 + "</span>, </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">paste0</span>(<span class="st">"I(X"</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(real), <span class="st">"^2)"</span>, <span class="at">collapse =</span> <span class="st">" + "</span>),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">" + "</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">paste0</span>(<span class="st">"I(X"</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(real), <span class="st">"^3)"</span>, <span class="at">collapse =</span> <span class="st">" + "</span>))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                    dat <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(<span class="at">Real =</span> <span class="fu">data.frame</span>(real),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">Synthetic =</span> <span class="fu">data.frame</span>(synthetic),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">.id =</span> <span class="st">"Synthetic"</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                    X   <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="fu">as.formula</span>(form), dat)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>                    Y   <span class="ot">&lt;-</span> <span class="fu">factor</span>(dat<span class="sc">$</span>Synthetic)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>                    mod <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                    p   <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, <span class="at">newx =</span> X, <span class="at">s =</span> mod<span class="sc">$</span>lambda.min, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">mean</span>((p<span class="fl">-0.5</span>)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> ((<span class="fu">ncol</span>(X))<span class="sc">*</span><span class="fl">0.5</span><span class="sc">^</span><span class="dv">3</span><span class="sc">/</span><span class="fu">nrow</span>(X))</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>                  })</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">CART =</span> CART,</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">Logistic =</span> logistic,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">Lasso =</span> lasso) <span class="sc">|&gt;</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>() <span class="sc">|&gt;</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:right;"> CART </th>
   <th style="text-align:right;"> Logistic </th>
   <th style="text-align:right;"> Lasso </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 2.367334 </td>
   <td style="text-align:right;"> 36.31075 </td>
   <td style="text-align:right;"> 21.3709364 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2.519016 </td>
   <td style="text-align:right;"> 11.44123 </td>
   <td style="text-align:right;"> 3.7447982 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2.462893 </td>
   <td style="text-align:right;"> 5.23619 </td>
   <td style="text-align:right;"> 0.8480817 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>So, we can conclude that the <span class="math inline">\(pMSE\)</span> is not very good at detecting missed relationships between variables, and the problem gets worse when the dimensionality of the data increases. Note that the estimates of the lasso are conservative, as the number of variables in the predictor matrix is chosen to be the number of parameters in the model (and thus shrinkage is not accounted for). Using a (probably) overly optimistic estimate (only the non-zero coefficients), the standardized <span class="math inline">\(pMSE\)</span> would be around <span class="math inline">\(7\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map2</span>(<span class="fu">list</span>(XR3, XR10, XR20),</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">list</span>(XS3, XS10, XS20),</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>     <span class="sc">~</span><span class="fu">utility.tables</span>(<span class="fu">data.frame</span>(.x), <span class="fu">data.frame</span>(.y)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]

Two-way utility: S_pMSE value plotted for 3 pairs of variables.

Variable combinations with worst 3 utility scores (S_pMSE):
2.X2:3.X3 1.X1:3.X3 1.X1:2.X2 
   7.2140    6.5666    4.5826 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="test_pmse_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Medians and maxima of selected utility measures for all tables compared
       Medians  Maxima
pMSE    0.0197  0.0216
S_pMSE  6.5666  7.2140
df     24.0000 24.0000

For more details of all scores use print.tabs = TRUE.

[[2]]

Two-way utility: S_pMSE value plotted for 45 pairs of variables.

Variable combinations with worst 5 utility scores (S_pMSE):
02.X2:03.X3 01.X1:08.X8 06.X6:07.X7 06.X6:09.X9 01.X1:06.X6 
     9.2868      8.7732      8.1683      8.1605      8.0266 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="test_pmse_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Medians and maxima of selected utility measures for all tables compared
       Medians  Maxima
pMSE    0.0196  0.0279
S_pMSE  6.5431  9.2868
df     24.0000 24.0000

For more details of all scores use print.tabs = TRUE.

[[3]]

Two-way utility: S_pMSE value plotted for 190 pairs of variables.

Variable combinations with worst 5 utility scores (S_pMSE):
  01.X1:06.X6 10.X10:12.X12  06.X6:10.X10  07.X7:18.X18 13.X13:20.X20 
      10.5229        9.8592        9.6286        9.1604        8.9764 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="test_pmse_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Medians and maxima of selected utility measures for all tables compared
       Medians  Maxima
pMSE    0.0194  0.0316
S_pMSE  6.4558 10.5229
df     24.0000 24.0000

For more details of all scores use print.tabs = TRUE.</code></pre>
</div>
</div>
<p>According to the figures, the same findings hold for two-way assessments of utility (i.e., for pairs of variables).</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>